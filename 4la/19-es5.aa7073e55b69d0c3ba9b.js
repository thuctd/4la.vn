function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),t}(window.webpackJsonp=window.webpackJsonp||[]).push([[19],{Qq7v:function(t,e,i){"use strict";i.r(e),i.d(e,"VehicleModule",(function(){return Ot}));var n,c,o=i("SVse"),a=i("COeT"),r=i("8Y7J"),s=i("IheW"),l=((c=function(){function t(e,i){_classCallCheck(this,t),this.http=e,this.plus=i,this.httpOptions=this.plus.getHeader(),this.apiUrl=this.plus.getApiUrl("settlement/"),this.collection="settlement"}return _createClass(t,[{key:"get",value:function(){return this.http.get(this.apiUrl,this.httpOptions)}},{key:"getByMonth",value:function(t){return this.http.get(this.apiUrl+"getByMonth/"+t,this.httpOptions)}},{key:"getByIdMonth",value:function(t,e){return console.log(t,e),this.http.get(this.apiUrl+"id/"+t+"/month/"+e,this.httpOptions)}},{key:"create",value:function(t){return this.http.post(this.apiUrl,t,this.httpOptions)}},{key:"update",value:function(t){return this.http.put(this.apiUrl,t,this.httpOptions)}},{key:"delete",value:function(t){return this.http.delete(this.apiUrl+t,this.httpOptions)}},{key:"find",value:function(t){return this.http.post(this.apiUrl+"/find",t,this.httpOptions)}}]),t}()).\u0275fac=function(t){return new(t||c)(r.cc(s.a),r.cc(a.a))},c.\u0275prov=r.Ob({token:c,factory:c.\u0275fac,providedIn:"root"}),c),b=((n=function(){function t(e,i){_classCallCheck(this,t),this.http=e,this.plus=i,this.httpOptions=this.plus.getHeader(),this.apiUrl=this.plus.getApiUrl("vehicle/"),this.collection="vehicle"}return _createClass(t,[{key:"get",value:function(){return this.http.get(this.apiUrl,this.httpOptions)}},{key:"getByStatus",value:function(){return this.http.get(this.apiUrl,this.httpOptions)}},{key:"getForOrder",value:function(){return this.http.get(this.apiUrl+"order",this.httpOptions)}},{key:"create",value:function(t){return this.http.post(this.apiUrl,t,this.httpOptions)}},{key:"update",value:function(t){return this.http.put(this.apiUrl,t,this.httpOptions)}},{key:"delete",value:function(t){return this.http.delete(this.apiUrl+t,this.httpOptions)}},{key:"find",value:function(t){return this.http.post(this.apiUrl+"/find",t,this.httpOptions)}}]),t}()).\u0275fac=function(t){return new(t||n)(r.cc(s.a),r.cc(a.a))},n.\u0275prov=r.Ob({token:n,factory:n.\u0275fac,providedIn:"root"}),n),h=i("s7LF"),d=i("Kj3r"),u=i("EUZL");function p(t,e){1&t&&(r.Yb(0,"div",8),r.Tb(1,"i",9),r.Xb())}function f(t,e){if(1&t){var i=r.Zb();r.Yb(0,"tbody"),r.Yb(1,"tr"),r.Yb(2,"td",16),r.fc("click",(function(){r.zc(i);var t=e.$implicit;return r.jc(2).log(t)})),r.Jc(3),r.Xb(),r.Yb(4,"td"),r.Jc(5),r.Xb(),r.Yb(6,"td"),r.Jc(7),r.kc(8,"number"),r.Xb(),r.Yb(9,"td"),r.Jc(10),r.kc(11,"number"),r.Xb(),r.Yb(12,"td"),r.Yb(13,"button",17),r.fc("click",(function(){r.zc(i);var t=e.$implicit;return r.jc(2).delSettlement(t._id)})),r.Tb(14,"i",18),r.Xb(),r.Xb(),r.Xb(),r.Xb()}if(2&t){var n=e.$implicit;r.Hb(3),r.Kc(n.vehicleId.label),r.Hb(2),r.Kc(n.vehicleId.fuel),r.Hb(2),r.Kc(r.lc(8,4,n.used)),r.Hb(3),r.Kc(r.lc(11,6,n.fuelAdvance))}}function m(t,e){if(1&t){var i=r.Zb();r.Yb(0,"div",10),r.Yb(1,"h4",11),r.Jc(2,"B\u1ea2NG QUY\u1ebeT TO\xc1N NHI\xcaN LI\u1ec6U "),r.Yb(3,"i",12),r.fc("click",(function(){return r.zc(i),r.jc().download()})),r.Xb(),r.Xb(),r.Yb(4,"table",13),r.Yb(5,"thead",14),r.Yb(6,"tr"),r.Yb(7,"th"),r.Jc(8,"Bi\u1ec3n s\u1ed1 xe"),r.Xb(),r.Yb(9,"th"),r.Jc(10,"Nhi\xean li\u1ec7u s\u1eed d\u1ee5ng"),r.Xb(),r.Yb(11,"th"),r.Jc(12,"S\u1ed1 Km ch\u1ed1t"),r.Xb(),r.Yb(13,"th"),r.Jc(14,"Nhi\xean li\u1ec7u t\u1ea1m \u1ee9ng"),r.Xb(),r.Tb(15,"th"),r.Xb(),r.Xb(),r.Hc(16,f,15,8,"tbody",15),r.Xb(),r.Xb()}if(2&t){var n=r.jc();r.Hb(16),r.pc("ngForOf",n.vehiclesCheck)}}function v(t,e){if(1&t){var i=r.Zb();r.Yb(0,"tr"),r.Yb(1,"td",16),r.fc("click",(function(){r.zc(i);var t=e.$implicit;return r.jc(2).log(t)})),r.Jc(2),r.Xb(),r.Yb(3,"td"),r.Jc(4),r.Xb(),r.Yb(5,"td"),r.Jc(6),r.Xb(),r.Yb(7,"td"),r.Yb(8,"button",22),r.fc("click",(function(){r.zc(i);var t=e.$implicit;return r.jc(2).selectItem(t)})),r.Jc(9,"Ch\u1ed1t km"),r.Xb(),r.Xb(),r.Xb()}if(2&t){var n=e.$implicit;r.Hb(2),r.Kc(n.label),r.Hb(2),r.Kc(n.brand),r.Hb(2),r.Kc(n.manager.fullName||n.manager.displayName)}}function g(t,e){if(1&t&&(r.Yb(0,"div",10),r.Yb(1,"H4",19),r.Jc(2,"DANH S\xc1CH CH\u01afA CH\u1ed0T KM"),r.Xb(),r.Yb(3,"table",20),r.Yb(4,"thead",21),r.Yb(5,"tr"),r.Yb(6,"th"),r.Jc(7,"Bi\u1ec3n s\u1ed1"),r.Xb(),r.Yb(8,"th"),r.Jc(9,"Hi\u1ec7u xe"),r.Xb(),r.Yb(10,"th"),r.Jc(11,"Ng\u01b0\u1eddi qu\u1ea3n l\xfd"),r.Xb(),r.Tb(12,"th"),r.Xb(),r.Xb(),r.Yb(13,"tbody"),r.Hc(14,v,10,3,"tr",15),r.Xb(),r.Xb(),r.Xb()),2&t){var i=r.jc();r.Hb(14),r.pc("ngForOf",i.vehiclesFilter)}}function Y(t,e){if(1&t){var i=r.Zb();r.Yb(0,"div"),r.Yb(1,"h6"),r.Jc(2,"S\u1ed1 gi\u1edd c\u1ea9u "),r.Xb(),r.Yb(3,"input",40),r.fc("input",(function(){return r.zc(i),r.jc(2).used()})),r.Xb(),r.Xb()}}function X(t,e){if(1&t&&(r.Yb(0,"div",41),r.Yb(1,"h6"),r.Jc(2,"S\u1ed1 km th\xe1ng tr\u01b0\u1edbc: "),r.Yb(3,"span",42),r.Jc(4),r.kc(5,"number"),r.Xb(),r.Xb(),r.Tb(6,"hr"),r.Yb(7,"h6"),r.Jc(8),r.Xb(),r.Tb(9,"hr"),r.Yb(10,"h6"),r.Jc(11),r.kc(12,"number"),r.Xb(),r.Xb()),2&t){var i=r.jc(2);r.Hb(4),r.Lc("",r.lc(5,3,i.itemSelected.preUsed)," "),r.Hb(4),r.Lc("S\u1ed1 km th\u1ef1c hi\u1ec7n trong th\xe1ng: ",i.newUsed-i.itemSelected.preUsed||"Ch\u01b0a c\xf3 s\u1ed1 li\u1ec7u",""),r.Hb(3),r.Lc("T\u1ed5ng s\u1ed1 nhi\xean li\u1ec7u \u0111\u01b0\u1ee3c c\u1ea5p: ",r.mc(12,5,(i.newUsed-i.itemSelected.preUsed)*i.itemSelected.quota/100+(i.timeCrane*i.itemSelected.quotaCrane||0),"0.0-1")," l\xedt")}}function y(t,e){if(1&t){var i=r.Zb();r.Yb(0,"div",23),r.Yb(1,"div",24),r.Yb(2,"div",25),r.Yb(3,"div",26),r.Yb(4,"h5",27),r.Jc(5),r.Xb(),r.Yb(6,"button",28),r.Yb(7,"span",29),r.Jc(8,"\xd7"),r.Xb(),r.Xb(),r.Xb(),r.Yb(9,"div",30),r.Yb(10,"form",31),r.Yb(11,"div",32),r.Yb(12,"h6"),r.Jc(13,"S\u1ed1 km:"),r.Xb(),r.Yb(14,"input",33),r.fc("input",(function(){return r.zc(i),r.jc().used()})),r.Xb(),r.Hc(15,Y,4,0,"div",34),r.Yb(16,"h6"),r.Jc(17,"S\u1ed1 nhi\xean li\u1ec7u \u0111\xe3 t\u1ea1m \u1ee9ng "),r.Xb(),r.Tb(18,"input",35),r.Tb(19,"hr"),r.Hc(20,X,13,8,"div",36),r.Xb(),r.Xb(),r.Xb(),r.Yb(21,"div",37),r.Yb(22,"button",38),r.fc("click",(function(){return r.zc(i),r.jc().resetModal()})),r.Jc(23,"H\u1ee7y"),r.Xb(),r.Yb(24,"button",39),r.fc("click",(function(){return r.zc(i),r.jc().submit()})),r.Jc(25,"L\u01b0u"),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb()}if(2&t){var n=r.jc();r.Hb(5),r.Mc("Ch\u1ed1t s\u1ed1 km xe ",n.itemSelected.brand," - ",n.itemSelected.label,""),r.Hb(5),r.pc("formGroup",n.main),r.Hb(5),r.pc("ngIf",n.itemSelected.quotaCrane>0),r.Hb(5),r.pc("ngIf",n.newUsed>0||n.timeCrane>0),r.Hb(4),r.pc("disabled",!n.main.valid)}}var k,H,I=((k=function(){function t(e,i,n,c){_classCallCheck(this,t),this.fb=e,this.plus=i,this.vehicleService=n,this.settlementService=c,this.api="settlement/",this.vehicles=[],this.vehiclesFilter=[],this.vehiclesCheck=[],this.loading=!0,this.loadMoreBtn=!1,this.today=this.plus.dateYMD((new Date).toISOString()),this.newUsed=0,this.timeCrane=0,this.data=[[1,2],[3,4]],this.wopts={bookType:"xlsx",type:"array"},this.fileName="SheetJS.xlsx",this.month=null,this.main=this.fb.group({preUsed:[,[h.s.required]],used:[,[h.s.required]],timeCrane:[0,[h.s.max(255)]],fuelAdvance:[0,[]],quotaSet:[,[h.s.required]]}),this.search=this.fb.group({what:["",[h.s.minLength(3),h.s.maxLength(100)]]}),this.dateForm=this.fb.group({date:[this.today,[h.s.required]]})}return _createClass(t,[{key:"ngOnInit",value:function(){this.getVehicles()}},{key:"getVehicles",value:function(){var t=this;this.vehicleService.get().subscribe((function(e){e?(t.vehicles=e,t.getVehiclesCheck()):t.plus.alertToasrt({war:"Vui l\xf2ng th\u1eed l\u1ea1i sau v\xe0i ph\xfat"})})),this.loading=!1}},{key:"getVehiclesCheck",value:function(){var t=this;this.loading=!0;var e=this.dateForm.value.date.slice(0,7);this.month=e,console.log(e),this.plus.httpGet(this.api+"getByMonth/"+e).subscribe((function(e){console.log(e),t.plus.alertToasrt(e),e?(t.vehiclesCheck=e,t.vehiclesFilter=t.plus.compareObj(t.vehicles,e),console.log(t.vehiclesFilter)):t.plus.alertToasrt({err:"L\u1ed7i k\u1ebft n\u1ed1i"}),console.log(t.vehiclesCheck),t.loading=!1}))}},{key:"selectItem",value:function(t){var e=this;console.log(t),this.itemSelected=t,this.main.controls.quotaSet.setValue(t.quota),this.main.controls.timeCrane.setValue(0),this.main.controls.fuelAdvance.setValue(0);var i=this.dateForm.get("date").value;this.plus.httpGet(this.api+"id/"+t._id+"/month/"+i).subscribe((function(t){console.log(t),t.length>0?(e.main.controls.preUsed.setValue(t[0].used),e.itemSelected.preUsed=t[0].used):(e.plus.alertToasrt({war:"B\u1ea1n ch\u01b0a ch\u1ed1t s\u1ed1 th\xe1ng tr\u01b0\u1edbc!"}),e.main.controls.preUsed.setValue(0),e.itemSelected.preUsed=0)})),console.log(this.itemSelected)}},{key:"submit",value:function(){var t=this,e=this.main.value;e.month=this.dateForm.value.date.slice(0,7),e.vehicleId=this.itemSelected._id;var i=this.plus.generateData(e);console.log("SUBMIT -> ",i),this.plus.httpPost(this.api,i).subscribe((function(e){t.plus.alertToasrt(e),t.ngOnInit(),t.resetModal()}))}},{key:"resetModal",value:function(){this.plus.clickBtn("closeModal"),this.itemSelected=null,this.newUsed=0,this.main.reset()}},{key:"delSettlement",value:function(t){var e=this;confirm("Xo\xe1 m\u1ee5c n\xe0y?")?(this.loading=!0,console.log(t),this.plus.httpDelete(this.api,t).subscribe((function(t){e.plus.alertToasrt(t),e.ngOnInit()}))):this.plus.alertToasrt({war:"\u0110\xe3 h\u1ee7y"})}},{key:"find",value:function(){var t=this;this.search.valid&&this.search.valueChanges.pipe(Object(d.a)(2e3)).subscribe((function(e){console.log(e),t.loading=!0,e.what=t.plus.removeAccents(e.what),t.vehicleService.find(e).subscribe((function(e){e.length>0&&(t.vehicles=e.sort((function(t,e){return t.dateModify-e.dateModify}))),t.loadMoreBtn=!0,t.loading=!1}))}))}},{key:"loadMore",value:function(){var t=this;this.loading=!0;var e=Math.ceil(this.vehicles.length/10)+1,i=this.search.value;i.what=this.plus.removeAccents(i.what),i.page=e,this.vehicleService.find(i).subscribe((function(e){e.length>0?e.forEach((function(e){t.vehicles.push(e)})):(t.plus.alertToasrt({msg:"Kh\xf4ng c\xf2n k\u1ebft qu\u1ea3 ph\xf9 h\u1ee3p \n Nh\u1eadp n\u1ed9i dung c\u1ea7n t\xecm c\u1ee5 th\u1ec3 h\u01a1n"}),t.loadMoreBtn=!1),t.loading=!1}))}},{key:"toYM",value:function(t){return t.slice(0,6)}},{key:"used",value:function(){this.newUsed=this.main.get("used").value,this.timeCrane=this.main.get("timeCrane").value}},{key:"log",value:function(t){return console.log(t)}},{key:"download",value:function(){var t=JSON.parse(localStorage.getItem("usrInfo"));t.unit&&t.fullName||this.plus.alertToasrt({err:"B\u1ea1n c\u1ea7n khai b\xe1o th\xeam th\xf4ng tin t\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n"})}},{key:"export",value:function(){this.vehicles.push("asdasasdas");var t=u.utils.table_to_sheet("settlement");console.log(t);var e=u.utils.book_new();u.utils.book_append_sheet(e,t,"Sheet1"),u.writeFile(e,this.fileName)}}]),t}()).\u0275fac=function(t){return new(t||k)(r.Sb(h.c),r.Sb(a.a),r.Sb(b),r.Sb(l))},k.\u0275cmp=r.Mb({type:k,selectors:[["app-settlement"]],decls:10,vars:5,consts:[[1,"container"],[1,"form-group",3,"formGroup"],["for",""],["type","date","formControlName","date",1,"form-control",3,"change"],["class","text-center text-primary",4,"ngIf"],[1,"row"],["class","col",4,"ngIf"],["class","modal fade","id","modelId","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",4,"ngIf"],[1,"text-center","text-primary"],[1,"fa","fa-spinner","fa-spin",2,"font-size","36px"],[1,"col"],[1,"text-center","text-success","py-2"],["aria-hidden","true",1,"fa","fa-download","text-primary",3,"click"],["id","settlement",1,"table","table-hover"],[1,"thead-default"],[4,"ngFor","ngForOf"],[3,"click"],["type","button",1,"btn","btn-danger",3,"click"],[1,"fa","fa-trash"],[1,"text-center","text-warning","py-2"],[1,"table","table-hover"],[1,"thead-inverse"],["type","button","data-toggle","modal","data-target","#modelId",1,"btn","btn-primary",3,"click"],["id","modelId","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header","bg-primary"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[3,"formGroup"],[1,"form-group"],["type","number","placeholder","Nh\u1eadp s\u1ed1 km ch\u1ed1t trong th\xe1ng","formControlName","used",1,"form-control",3,"input"],[4,"ngIf"],["type","number","placeholder","Nh\u1eadp s\u1ed1 l\xedt nhi\xean li\u1ec7u \u0111\xe3 t\u1ea1m \u1ee9ng","formControlName","fuelAdvance",1,"form-control"],["class","calculator",4,"ngIf"],[1,"modal-footer"],["type","button","id","closeModal","data-dismiss","modal",1,"btn","btn-secondary",3,"click"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"disabled","click"],["type","number","placeholder","Nh\u1eadp s\u1ed1 l\xedt nhi\xean li\u1ec7u \u0111\xe3 t\u1ea1m \u1ee9ng","formControlName","timeCrane",1,"form-control",3,"input"],[1,"calculator"],[1,"text-danger","font-weight-bold"]],template:function(t,e){1&t&&(r.Yb(0,"div",0),r.Yb(1,"div",1),r.Tb(2,"label",2),r.Jc(3,"Ch\u1ecdn th\xe1ng: "),r.Yb(4,"input",3),r.fc("change",(function(){return e.ngOnInit()})),r.Xb(),r.Xb(),r.Hc(5,p,2,0,"div",4),r.Yb(6,"div",5),r.Hc(7,m,17,1,"div",6),r.Hc(8,g,15,1,"div",6),r.Xb(),r.Xb(),r.Hc(9,y,26,6,"div",7)),2&t&&(r.Hb(1),r.pc("formGroup",e.dateForm),r.Hb(4),r.pc("ngIf",e.loading),r.Hb(2),r.pc("ngIf",e.vehiclesCheck.length>0),r.Hb(1),r.pc("ngIf",e.vehiclesFilter.length>0),r.Hb(1),r.pc("ngIf",e.itemSelected))},directives:[h.k,h.e,h.b,h.j,h.d,o.m,o.l,h.u,h.o],pipes:[o.e],styles:[""]}),k),J=i("iInd"),x=((H=function(){function t(e,i){_classCallCheck(this,t),this.http=e,this.plus=i,this.httpOptions=this.plus.getHeader(),this.apiUrl=this.plus.getApiUrl("order/"),this.collection="order"}return _createClass(t,[{key:"get",value:function(){return this.http.get(this.apiUrl,this.httpOptions)}},{key:"create",value:function(t){return this.http.post(this.apiUrl,t,this.httpOptions)}},{key:"update",value:function(t){return this.http.put(this.apiUrl,t,this.httpOptions)}},{key:"updateContact",value:function(t){return this.http.put(this.apiUrl+"contacts",t,this.httpOptions)}},{key:"delete",value:function(t){return this.http.delete(this.apiUrl+t,this.httpOptions)}},{key:"find",value:function(t){return this.http.post(this.apiUrl+"find",t,this.httpOptions)}},{key:"getByDate",value:function(t){return this.http.post(this.apiUrl+"orderDate",t,this.httpOptions)}},{key:"wait",value:function(t){return this.http.post(this.apiUrl+"wait",t,this.httpOptions)}},{key:"cancelWait",value:function(t){return this.http.delete(this.apiUrl+"wait/"+t,this.httpOptions)}}]),t}()).\u0275fac=function(t){return new(t||H)(r.cc(s.a),r.cc(a.a))},H.\u0275prov=r.Ob({token:H,factory:H.\u0275fac,providedIn:"root"}),H),T=function t(){_classCallCheck(this,t)};function S(t,e){1&t&&(r.Yb(0,"div",17),r.Tb(1,"i",18),r.Xb())}function C(t,e){if(1&t){var i=r.Zb();r.Yb(0,"button",20),r.fc("click",(function(){r.zc(i);var t=r.jc().$implicit;return r.jc(2).compOrder(t)})),r.Jc(1," \u0110i gh\xe9p "),r.Xb()}}function w(t,e){if(1&t&&(r.Yb(0,"tr"),r.Yb(1,"td"),r.Jc(2),r.Xb(),r.Yb(3,"td"),r.Jc(4),r.Xb(),r.Yb(5,"td"),r.Jc(6),r.Xb(),r.Yb(7,"td"),r.Jc(8),r.Xb(),r.Yb(9,"td"),r.Jc(10),r.Xb(),r.Yb(11,"td"),r.Hc(12,C,2,0,"button",19),r.Xb(),r.Xb()),2&t){var i=e.$implicit;r.Hb(2),r.Kc(i.vehicleId.type),r.Hb(2),r.Kc(i.vehicleId.label),r.Hb(2),r.Kc(i.how),r.Hb(2),r.Kc(i.pointDes||"Xe \u0111ang \u0111\u01b0\u1ee3c ng\u01b0\u1eddi kh\xe1c \u0111\u0103ng k\xfd"),r.Hb(2),r.Kc(1===i.orderStatus?"\u0110\xe3 duy\u1ec7t":"Ch\u1edd duy\u1ec7t"),r.Hb(2),r.pc("ngIf",0===i.orderStatus)}}function O(t,e){if(1&t&&(r.Yb(0,"tbody"),r.Hc(1,w,13,6,"tr",15),r.Xb()),2&t){var i=r.jc();r.Hb(1),r.pc("ngForOf",i.orderList)}}function M(t,e){if(1&t){var i=r.Zb();r.Yb(0,"tr"),r.Yb(1,"td"),r.Jc(2),r.Xb(),r.Yb(3,"td"),r.Jc(4),r.Xb(),r.Yb(5,"td"),r.Yb(6,"button",21),r.fc("click",(function(){r.zc(i);var t=e.$implicit;return r.jc().order(t)})),r.Jc(7," \u0110\u0103ng k\xfd "),r.Xb(),r.Xb(),r.Xb()}if(2&t){var n=e.$implicit,c=r.jc();r.Hb(2),r.Kc(n.label),r.Hb(2),r.Kc(n.type),r.Hb(2),r.rc("routerLink","/dangkyxe/token/",c.token,"")}}function N(t,e){if(1&t&&(r.Yb(0,"h6"),r.Jc(1),r.Xb()),2&t){var i=e.$implicit;r.Hb(1),r.Kc(i)}}function j(t,e){if(1&t){var i=r.Zb();r.Yb(0,"h6"),r.Jc(1),r.Yb(2,"i",38),r.fc("click",(function(){r.zc(i);var t=e.index;return r.jc(2).delContact(t)})),r.Xb(),r.Xb()}if(2&t){var n=e.$implicit;r.Hb(1),r.Lc("",n," ")}}function D(t,e){if(1&t){var i=r.Zb();r.Yb(0,"div",22),r.Yb(1,"div",23),r.Yb(2,"div",24),r.Yb(3,"div",25),r.Yb(4,"h5",26),r.Jc(5,"\u0110\u0102NG K\xdd \u0110I GH\xc9P"),r.Xb(),r.Yb(6,"button",27),r.Yb(7,"span",28),r.Jc(8,"\xd7"),r.Xb(),r.Xb(),r.Xb(),r.Yb(9,"div",29),r.Yb(10,"div",0),r.Yb(11,"div",6),r.Yb(12,"div",12),r.Yb(13,"h6"),r.Jc(14,"S\u1ed1 ng\u01b0\u1eddi \u0111i:"),r.Xb(),r.Xb(),r.Yb(15,"div",7),r.Yb(16,"h6"),r.Jc(17),r.Xb(),r.Xb(),r.Tb(18,"hr"),r.Xb(),r.Yb(19,"div",6),r.Yb(20,"div",12),r.Yb(21,"h6"),r.Jc(22,"C\xf4ng t\xe1c:"),r.Xb(),r.Xb(),r.Yb(23,"div",7),r.Yb(24,"h6"),r.Jc(25),r.Xb(),r.Xb(),r.Tb(26,"hr"),r.Xb(),r.Yb(27,"div",6),r.Yb(28,"div",12),r.Yb(29,"h6"),r.Jc(30,"Gi\u1edd \u0111i:"),r.Xb(),r.Xb(),r.Yb(31,"div",7),r.Yb(32,"h6"),r.Jc(33),r.Xb(),r.Xb(),r.Tb(34,"hr"),r.Xb(),r.Yb(35,"div",6),r.Yb(36,"div",12),r.Yb(37,"h6"),r.Jc(38,"Ng\xe0y \u0111i:"),r.Xb(),r.Xb(),r.Yb(39,"div",7),r.Yb(40,"h6"),r.Jc(41),r.kc(42,"date"),r.Xb(),r.Xb(),r.Tb(43,"hr"),r.Xb(),r.Yb(44,"div",6),r.Yb(45,"div",12),r.Yb(46,"h6"),r.Jc(47,"Gi\u1edd v\u1ec1:"),r.Xb(),r.Xb(),r.Yb(48,"div",7),r.Yb(49,"h6"),r.Jc(50),r.Xb(),r.Xb(),r.Tb(51,"hr"),r.Xb(),r.Yb(52,"div",6),r.Yb(53,"div",12),r.Yb(54,"h6"),r.Jc(55,"Ng\xe0y v\u1ec1:"),r.Xb(),r.Xb(),r.Yb(56,"div",7),r.Yb(57,"h6"),r.Jc(58),r.kc(59,"date"),r.Xb(),r.Xb(),r.Tb(60,"hr"),r.Xb(),r.Yb(61,"div",6),r.Yb(62,"div",12),r.Yb(63,"h6"),r.Jc(64,"\u0110i\u1ec3m xu\u1ea5t ph\xe1t:"),r.Xb(),r.Xb(),r.Yb(65,"div",7),r.Yb(66,"h6"),r.Jc(67),r.Xb(),r.Xb(),r.Tb(68,"hr"),r.Xb(),r.Yb(69,"div",6),r.Yb(70,"div",12),r.Yb(71,"h6"),r.Jc(72,"\u0110i\u1ec3m cu\u1ed1i:"),r.Xb(),r.Xb(),r.Yb(73,"div",7),r.Yb(74,"h6"),r.Jc(75),r.Xb(),r.Xb(),r.Tb(76,"hr"),r.Xb(),r.Yb(77,"div",6),r.Yb(78,"div",12),r.Yb(79,"h6"),r.Jc(80,"Li\xean h\u1ec7:"),r.Xb(),r.Xb(),r.Yb(81,"div",7),r.Hc(82,N,2,1,"h6",15),r.Hc(83,j,3,1,"h6",15),r.Yb(84,"form",30),r.Tb(85,"input",31),r.Yb(86,"button",32),r.fc("click",(function(){return r.zc(i),r.jc().addContact()})),r.Jc(87,"Th\xeam li\xean h\u1ec7"),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Yb(88,"div",33),r.Yb(89,"button",34),r.fc("click",(function(){return r.zc(i),r.jc().resetModal()})),r.Tb(90,"i",35),r.Xb(),r.Yb(91,"button",36),r.fc("click",(function(){return r.zc(i),r.jc().updateOrderContact()})),r.Tb(92,"i",37),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb()}if(2&t){var n=r.jc();r.Hb(17),r.Lc("",n.orderSelected.how," ng\u01b0\u1eddi"),r.Hb(8),r.Kc(n.orderSelected.todo),r.Hb(8),r.Kc(n.orderSelected.timeGo),r.Hb(8),r.Kc(r.mc(42,12,n.orderSelected.dateGo,"dd/MM/yyyy")),r.Hb(9),r.Kc(n.orderSelected.timeBack),r.Hb(8),r.Kc(r.mc(59,15,n.orderSelected.dayBack,"dd/MM/yyyy")),r.Hb(9),r.Kc(n.orderSelected.pointGo),r.Hb(8),r.Kc(n.orderSelected.pointDes),r.Hb(7),r.pc("ngForOf",n.orderSelected.contact),r.Hb(1),r.pc("ngForOf",n.contacts),r.Hb(1),r.pc("formGroup",n.contactForm),r.Hb(7),r.pc("disabled",0===n.contacts.length)}}var G,L=((G=function(){function t(e,i,n,c){_classCallCheck(this,t),this.plus=e,this.orderSV=i,this.vehicleSV=n,this.fb=c,this.vehicles=[],this.vehiclesWait=[],this.orderList=[],this.loading=!0,this.loadMoreBtn=!1,this.contacts=[],this.api="order/",this.today=this.plus.dateYMD((new Date).toISOString()),this.token=(new Date).getTime()+18e4,this.search=this.fb.group({what:["",[h.s.minLength(3),h.s.maxLength(100)]]}),this.dateForm=this.fb.group({dateGo:[this.today,[h.s.required,h.s.minLength(10),h.s.maxLength(10)]]}),this.contactForm=this.fb.group({pesonnel:["",h.s.required]})}return _createClass(t,[{key:"ngOnInit",value:function(){this.getVehicles()}},{key:"find",value:function(){var t=this;this.search.valueChanges.pipe(Object(d.a)(1500)).subscribe((function(e){t.search.valid&&(e.what=t.plus.removeAccents(e.what),t.loading=!0,t.orderSV.find(e).subscribe((function(e){e.length>0&&(t.orderList=e.sort((function(t,e){return t.dateModify-e.dateModify}))),t.loadMoreBtn=!0,t.loading=!1})))}))}},{key:"getVehicles",value:function(){var t=this;this.plus.httpGet("vehicle/order/").subscribe((function(e){e?(t.vehicles=e,t.getOrderDay(t.today)):t.plus.alertToasrt({war:"Vui l\xf2ng th\u1eed l\u1ea1i sau v\xe0i ph\xfat"})})),this.loading=!1}},{key:"getOrders",value:function(){var t=this,e=this.dateForm.value;this.dateForm.valid&&(this.loading=!0,this.orderList=[],this.plus.httpPost("order/orderDate",e).subscribe((function(e){t.plus.alertToasrt(e),t.vehiclesWait=t.plus.compareObj(t.vehicles,e),t.loading=!1,t.orderList=e,t.delWait(e)})))}},{key:"getOrderDay",value:function(t){var e=this;this.plus.httpPost("order/orderDate",{dateGo:t}).subscribe((function(t){e.plus.alertToasrt(t),e.vehiclesWait=e.plus.compareObj(e.vehicles,t),e.loading=!1,e.orderList=t,e.delWait(t)}))}},{key:"loadMore",value:function(){var t=this;this.loading=!0;var e=Math.ceil(this.orderList.length/10)+1,i=this.search.value;i.what=this.plus.removeAccents(i.what),i.page=e,this.orderSV.find(i).subscribe((function(e){e.length>0?e.forEach((function(e){t.orderList.push(e)})):(t.plus.alertToasrt({msg:"Kh\xf4ng c\xf2n k\u1ebft qu\u1ea3 ph\xf9 h\u1ee3p \n Nh\u1eadp n\u1ed9i dung c\u1ea7n t\xecm c\u1ee5 th\u1ec3 h\u01a1n"}),t.loadMoreBtn=!1),t.loading=!1}))}},{key:"resetModal",value:function(){this.contacts=[]}},{key:"wait",value:function(t){var e=this;this.orderSV.vehicle=t;var i=this.dateForm.value;this.orderSV.dateGo=i.dateGo,this.orderSV.wait({vehicleId:t._id,dateGo:i.dateGo}).subscribe((function(t){return e.plus.alertToasrt(t)}))}},{key:"delWait",value:function(t){var e=this,i=Date.now();t.length>0&&t.forEach((function(t,n){3===t.orderStatus&&t.canEdit-i<0&&e.plus.httpDelete("order/wait/",t._id).subscribe((function(t){t.id&&e.getOrders()}))}))}},{key:"order",value:function(t){var e=this.dateForm.value;e.vehicle=t,e.token=this.token,console.log(e),localStorage.setItem("order",JSON.stringify(e))}},{key:"compOrder",value:function(t){this.orderSelected=t}},{key:"addContact",value:function(){this.contacts.push(this.contactForm.value.pesonnel),this.contactForm.reset()}},{key:"delContact",value:function(t){this.contacts.splice(t,1)}},{key:"updateOrderContact",value:function(){var t=this;this.orderSelected.contact=this.contacts.concat(this.orderSelected.contact);var e=this.plus.addKeyWord(this.orderSelected),i=new T;i._id=this.orderSelected._id,i.contact=e.contact,i.keyWord=e.keyWord,this.orderSV.updateContact(i).subscribe((function(e){t.plus.alertToasrt(e),t.plus.clickBtn("closeModal")})),this.contacts=[]}}]),t}()).\u0275fac=function(t){return new(t||G)(r.Sb(a.a),r.Sb(x),r.Sb(b),r.Sb(h.c))},G.\u0275cmp=r.Mb({type:G,selectors:[["app-order-list"]],decls:41,vars:5,consts:[[1,"container-fluid"],[1,"text-center","bg-warning","py-2","rounded"],[1,"form-group",3,"formGroup"],["for",""],["type","date","formControlName","dateGo",1,"form-control",3,"change"],["class","text-center text-primary",4,"ngIf"],[1,"row"],[1,"col-sm-8"],[1,"text-center","bg-info","py-2","rounded"],[1,"table","table-hover","table-inverse"],[1,"thead-inverse"],[4,"ngIf"],[1,"col-sm-4"],[1,"text-center","bg-success","py-2","rounded"],[1,"text-center"],[4,"ngFor","ngForOf"],["class","modal fade","id","modelId","tabindex","-1",4,"ngIf"],[1,"text-center","text-primary"],[1,"fa","fa-spinner","fa-spin",2,"font-size","36px"],["type","button","class","btn btn-outline-success mx-1","data-toggle","modal","data-target","#modelId",3,"click",4,"ngIf"],["type","button","data-toggle","modal","data-target","#modelId",1,"btn","btn-outline-success","mx-1",3,"click"],["type","button",1,"btn","btn-outline-success",3,"routerLink","click"],["id","modelId","tabindex","-1",1,"modal","fade"],["role","document",1,"modal-dialog","modal-lg"],[1,"modal-content"],[1,"modal-header","bg-primary","text-white"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],[1,"contact",3,"formGroup"],["type","text","placeholder","H\u1ecd v\xe0 t\xean + s\u1ed1 \u0111i\u1ec7n tho\u1ea1i, N\u01a1i \u0111\xf3n ...","required","","formControlName","pesonnel",1,"form-control","mb-2"],[1,"btn","btn-outline-info","my-1",3,"click"],[1,"modal-footer"],["type","button","id","closeModal","data-dismiss","modal",1,"btn","btn-outline-danger","mx-2",3,"click"],[1,"fa","fa-times","text-danger"],["type","button",1,"btn","btn-outline-primary","mx-2",3,"disabled","click"],[1,"fa","fa-floppy-o"],[1,"fa","fa-trash","text-danger",3,"click"]],template:function(t,e){1&t&&(r.Yb(0,"div",0),r.Yb(1,"h4",1),r.Jc(2,"\u0110\u0102NG K\xdd XE C\xd4NG T\xc1C"),r.Xb(),r.Yb(3,"div",2),r.Tb(4,"label",3),r.Jc(5,"Ch\u1ecdn ng\xe0y \u0111i: "),r.Yb(6,"input",4),r.fc("change",(function(){return e.getOrders()})),r.Xb(),r.Xb(),r.Hc(7,S,2,0,"div",5),r.Yb(8,"div",6),r.Yb(9,"div",7),r.Yb(10,"h5",8),r.Jc(11,"DANH S\xc1CH XE \u0110\xc3 \u0110\u0102NG K\xdd"),r.Xb(),r.Yb(12,"table",9),r.Yb(13,"thead",10),r.Yb(14,"tr"),r.Yb(15,"th"),r.Jc(16,"Lo\u1ea1i xe"),r.Xb(),r.Yb(17,"th"),r.Jc(18,"Bi\u1ec3n s\u1ed1"),r.Xb(),r.Yb(19,"th"),r.Jc(20,"S\u1ed1 ng\u01b0\u1eddi \u0111i"),r.Xb(),r.Yb(21,"th"),r.Jc(22,"\u0110i\u1ec3m \u0111\u1ebfn"),r.Xb(),r.Yb(23,"th"),r.Jc(24,"Tr\u1ea1ng th\xe1i"),r.Xb(),r.Tb(25,"th"),r.Xb(),r.Xb(),r.Hc(26,O,2,1,"tbody",11),r.Xb(),r.Xb(),r.Yb(27,"div",12),r.Yb(28,"h5",13),r.Jc(29,"DANH S\xc1CH XE CH\u1edc"),r.Xb(),r.Yb(30,"table",9),r.Yb(31,"thead",10),r.Yb(32,"tr"),r.Yb(33,"th"),r.Jc(34,"Bi\u1ec3n s\u1ed1"),r.Xb(),r.Yb(35,"th"),r.Jc(36,"Lo\u1ea1i xe"),r.Xb(),r.Tb(37,"th",14),r.Xb(),r.Xb(),r.Yb(38,"tbody"),r.Hc(39,M,8,3,"tr",15),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Hc(40,D,93,18,"div",16),r.Xb()),2&t&&(r.Hb(3),r.pc("formGroup",e.dateForm),r.Hb(4),r.pc("ngIf",e.loading),r.Hb(19),r.pc("ngIf",e.orderList.length>0),r.Hb(13),r.pc("ngForOf",e.vehiclesWait),r.Hb(1),r.pc("ngIf",e.orderSelected))},directives:[h.k,h.e,h.b,h.j,h.d,o.m,o.l,J.c,h.u,h.q],pipes:[o.d],styles:[""]}),G);function B(t,e){1&t&&(r.Yb(0,"div",7),r.Tb(1,"i",8),r.Xb())}function K(t,e){if(1&t){var i=r.Zb();r.Yb(0,"button",16),r.fc("click",(function(){r.zc(i);var t=r.jc().$implicit;return r.jc(2).onDelete(t)})),r.Tb(1,"i",17),r.Xb()}}function _(t,e){if(1&t){var i=r.Zb();r.Yb(0,"tr"),r.Yb(1,"td"),r.Jc(2),r.Xb(),r.Yb(3,"td"),r.Jc(4),r.kc(5,"date"),r.Xb(),r.Yb(6,"td"),r.Jc(7),r.kc(8,"date"),r.Xb(),r.Yb(9,"td"),r.Jc(10),r.Xb(),r.Yb(11,"td",11),r.Yb(12,"button",13),r.fc("click",(function(){r.zc(i);var t=e.$implicit;return r.jc(2).download(t)})),r.Tb(13,"i",14),r.Xb(),r.Hc(14,K,2,0,"button",15),r.Xb(),r.Xb()}if(2&t){var n=e.$implicit;r.Hb(2),r.Kc(n.todo),r.Hb(2),r.Kc(r.mc(5,5,n.dateGo,"dd/MM/yyyy")),r.Hb(3),r.Kc(r.mc(8,8,n.dayBack,"dd/MM/yyyy")),r.Hb(3),r.Kc(n.pointDes),r.Hb(4),r.pc("ngIf",1!==n.orderStatus)}}function F(t,e){if(1&t&&(r.Yb(0,"table",9),r.Yb(1,"thead",10),r.Yb(2,"tr"),r.Yb(3,"th"),r.Jc(4,"C\xf4ng t\xe1c"),r.Xb(),r.Yb(5,"th"),r.Jc(6,"Ng\xe0y \u0111i"),r.Xb(),r.Yb(7,"th"),r.Jc(8,"Ng\xe0y v\u1ec1"),r.Xb(),r.Yb(9,"th"),r.Jc(10,"\u0110i\u1ec3m c\xf4ng t\xe1c"),r.Xb(),r.Tb(11,"th",11),r.Xb(),r.Xb(),r.Yb(12,"tbody"),r.Hc(13,_,15,11,"tr",12),r.Xb(),r.Xb()),2&t){var i=r.jc();r.Hb(13),r.pc("ngForOf",i.datalist)}}function V(t,e){if(1&t){var i=r.Zb();r.Yb(0,"div",11),r.Yb(1,"button",18),r.fc("click",(function(){return r.zc(i),r.jc().loadMore()})),r.Jc(2," K\u1ebft qu\u1ea3 kh\xe1c "),r.Xb(),r.Xb()}}var U,q,z=function(t){return{loading:t}},$=((q=function(){function t(e,i,n,c){_classCallCheck(this,t),this.plus=e,this.DB=i,this.fb=n,this.vehicleSV=c,this.vehicles=[],this.loading=!0,this.search=this.fb.group({what:["",[h.s.minLength(3),h.s.maxLength(100)]]})}return _createClass(t,[{key:"ngOnInit",value:function(){this.getOrders(),this.find()}},{key:"getOrders",value:function(){var t=this;this.DB.get().subscribe((function(e){t.loading=!1,t.datalist=e,t.plus.alertToasrt(e)}))}},{key:"getVehicles",value:function(){var t=this;this.vehicleSV.get().subscribe((function(e){t.vehicles=e,t.plus.alertToasrt(e)}))}},{key:"find",value:function(){var t=this;this.search.valid&&this.search.valueChanges.pipe(Object(d.a)(1e3)).subscribe((function(e){e.what=t.plus.removeAccents(e.what),t.loading=!0,t.DB.find(e).subscribe((function(e){e.length>0?t.datalist=e.sort((function(t,e){return t.dateModify-e.dateModify})):t.plus.alertToasrt({msg:"Kh\xf4ng c\xf3 k\u1ebft qu\u1ea3 ph\xf9 h\u1ee3p!"}),t.loadMoreBtn=!0,t.loading=!1}))}))}},{key:"loadMore",value:function(){var t=this;this.loading=!0;var e=Math.ceil(this.datalist.length/10)+1,i=this.search.value;i.what=this.plus.removeAccents(i.what),i.page=e,this.DB.find(i).subscribe((function(e){e.length>0?e.forEach((function(e){t.datalist.push(e)})):(t.plus.alertToasrt({msg:"Kh\xf4ng c\xf2n k\u1ebft qu\u1ea3 ph\xf9 h\u1ee3p \n Nh\u1eadp n\u1ed9i dung c\u1ea7n t\xecm c\u1ee5 th\u1ec3 h\u01a1n"}),t.loadMoreBtn=!1),t.loading=!1}))}},{key:"onEdit",value:function(t){console.log(t)}},{key:"onDelete",value:function(t){var e=this;console.log(t),1===t.orderStatus?this.plus.alertToasrt({err:"Vui l\xf2ng kh\xf4ng th\u1ef1c hi\u1ec7n l\u1ea1i! T\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n s\u1ebd b\u1ecb kho\xe1!"}):this.DB.delete(t._id).subscribe((function(t){e.plus.alertToasrt(t),e.getOrders()}))}},{key:"download",value:function(t){JSON.parse(localStorage.getItem("usrInfo")).unit||this.plus.alertToasrt({err:"B\u1ea1n c\u1ea7n khai b\xe1o th\xeam th\xf4ng tin t\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n"}),console.log(t);var e=Object.assign({},t);e.dateGo=this.plus.dateToDMY(e.dateGo),e.dayBack=this.plus.dateToDMY(e.dayBack)}}]),t}()).\u0275fac=function(t){return new(t||q)(r.Sb(a.a),r.Sb(x),r.Sb(h.c),r.Sb(b))},q.\u0275cmp=r.Mb({type:q,selectors:[["app-order-manager"]],decls:8,vars:7,consts:[[1,"container"],[1,"text-primary","text-center","bg-white","py-2","rounded"],[1,"form-group",3,"formGroup"],["list","students","type","text","formControlName","what","aria-describedby","helpId","placeholder","Nh\u1eadp th\xf4ng tin b\u1ea1n c\u1ea7n t\xecm","autocomplete","on",1,"form-control","text-danger",3,"ngClass"],["class","text-center text-primary",4,"ngIf"],["class","table table-hover table-inverse",4,"ngIf"],["class","text-center",4,"ngIf"],[1,"text-center","text-primary"],[1,"fa","fa-spinner","fa-spin",2,"font-size","36px"],[1,"table","table-hover","table-inverse"],[1,"thead-inverse"],[1,"text-center"],[4,"ngFor","ngForOf"],["type","button","data-toggle","modal","data-target","#modelId",1,"btn","btn-outline-primary","mx-1",3,"click"],["aria-hidden","true",1,"fa","fa-print","text-info"],["type","button","class","btn btn-outline-danger mx-1",3,"click",4,"ngIf"],["type","button",1,"btn","btn-outline-danger","mx-1",3,"click"],[1,"fa","fa-trash"],["type","button",1,"btn","btn-outline-primary",3,"click"]],template:function(t,e){1&t&&(r.Yb(0,"div",0),r.Yb(1,"h4",1),r.Jc(2," DANH S\xc1CH XE \u0110\xc3 \u0110\u0102NG K\xdd "),r.Xb(),r.Yb(3,"div",2),r.Tb(4,"input",3),r.Xb(),r.Hc(5,B,2,0,"div",4),r.Hc(6,F,14,1,"table",5),r.Hc(7,V,3,0,"div",6),r.Xb()),2&t&&(r.Hb(3),r.pc("formGroup",e.search),r.Hb(1),r.pc("ngClass",r.uc(5,z,e.loading)),r.Hb(1),r.pc("ngIf",e.loading),r.Hb(1),r.pc("ngIf",e.datalist),r.Hb(1),r.pc("ngIf",e.loadMoreBtn))},directives:[h.k,h.e,h.b,h.j,h.d,o.k,o.m,o.l],pipes:[o.d],styles:[""]}),q),A=((U=function(){function t(){_classCallCheck(this,t)}return _createClass(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||U)},U.\u0275cmp=r.Mb({type:U,selectors:[["app-vehicle"]],decls:2,vars:0,template:function(t,e){1&t&&(r.Yb(0,"p"),r.Jc(1,"vehicle !"),r.Xb())},styles:[""]}),U);function P(t,e){if(1&t&&(r.Yb(0,"h4",4),r.Jc(1),r.Xb()),2&t){var i=r.jc();r.Hb(1),r.Mc("Lo\u1ea1i xe: ",i.vehicle.type," - Bi\u1ec3n s\u1ed1: ",i.vehicle.label,"")}}function Z(t,e){if(1&t){var i=r.Zb();r.Yb(0,"div"),r.Yb(1,"p"),r.Jc(2),r.Yb(3,"i",23),r.fc("click",(function(){r.zc(i);var t=e.index;return r.jc().delContact(t)})),r.Xb(),r.Xb(),r.Xb()}if(2&t){var n=e.$implicit,c=e.index;r.Hb(2),r.Mc("",c+1,"./ ",n," ")}}function E(t,e){if(1&t){var i=r.Zb();r.Yb(0,"div",24),r.Yb(1,"button",25),r.fc("click",(function(){return r.zc(i),r.jc().submit()})),r.Tb(2,"i",26),r.Xb(),r.Yb(3,"button",27),r.fc("click",(function(){return r.zc(i),r.jc().back()})),r.Tb(4,"i",28),r.Xb(),r.Xb()}if(2&t){var n=r.jc();r.Hb(1),r.pc("disabled",!n.main.valid||0===n.contact.length)}}function W(t,e){1&t&&r.Tb(0,"option",29),2&t&&r.qc("value",e.$implicit)}var R,Q=((R=function(){function t(e,i,n,c,o,a,r){_classCallCheck(this,t),this.plus=e,this.DB=i,this.vehicleSV=n,this.fb=c,this.router=o,this.location=a,this.route=r,this.api="order/",this.vehicle=null,this.loading=!0,this.loadMoreBtn=!1,this.dateGo=null,this.contact=[],this.timeOut=!1,this.waitId="",this.token=null,this.over=null,this.time=[],this.main=this.fb.group({how:[,[h.s.required]],todo:[,[h.s.required]],timeGo:[,[h.s.required,h.s.minLength(5)]],dateGo:[,[h.s.required]],timeBack:[,[h.s.required,h.s.minLength(5)]],dayBack:[this.dateGo,[h.s.required]],pointGo:[],pointDes:[,[h.s.required]]}),this.contactForm=this.fb.group({pesonnel:["",h.s.required]})}return _createClass(t,[{key:"ngOnInit",value:function(){clearInterval(this.over),this.getById(),this.timeInit()}},{key:"getById",value:function(){var t=this,e=JSON.parse(localStorage.getItem("order"));if(console.log(e),!e||e.token<Date.now()||e.token-Date.now()>19e4)return this.router.navigate(["/dangkyxe"]);this.token=e.token,this.vehicle=e.vehicle,this.countDown(),this.plus.alertToasrt({msg:"Xe \u0111\u01b0\u1ee3c gi\u1eef cho b\u1ea1n 03 ph\xfat \u0111\u1ec3 ho\xe0n t\u1ea5t th\xf4ng tin!"}),this.main.controls.dateGo.setValue(e.dateGo),this.main.controls.dayBack.setValue(e.dateGo),this.plus.httpPost(this.api+"wait",{vehicleId:e.vehicle._id,dateGo:e.dateGo}).subscribe((function(e){t.waitId=e.id}))}},{key:"addContact",value:function(){this.contact.push(this.contactForm.value.pesonnel),this.contactForm.reset()}},{key:"delContact",value:function(t){this.contact.splice(t,1)}},{key:"submit",value:function(){var t=this,e=this.main.value;if(e.vehicleId=this.vehicle._id,e.driverId=this.vehicle.manager._id,e.contact=this.contact,new Date(e.dateGo)>new Date(e.dayBack))this.plus.alertToasrt({war:"Ng\xe0y v\u1ec1 ph\u1ea3i sau ng\xe0y \u0111i"});else{var i=this.plus.generateData(e);console.log(i),this.DB.create(i).subscribe((function(e){e.msg?(t.plus.alertToasrt(e),t.location.back(),clearInterval(t.over)):t.plus.alertToasrt(e)}))}}},{key:"back",value:function(){var t=this;clearInterval(this.over),this.location.back(),this.plus.httpDelete(this.api+"wait/",this.waitId).subscribe((function(e){t.plus.alertToasrt(e)}))}},{key:"countDown",value:function(){var t=this;clearInterval(this.over),this.over=setInterval((function(){var e=(new Date).getTime(),i=+t.token-e,n=Math.floor(i%36e5/6e4),c=Math.floor(i%6e4/1e3);t.remain=Math.round(100*(60*n+c)/180),console.log(t.over),localStorage.setItem("over",t.over),i<0&&(clearInterval(t.over),t.back())}),2e3)}},{key:"timeOver",value:function(){var t=this,e=setTimeout((function(){clearInterval(t.over),console.log("timeOver()",t.over),t.router.navigate(["/dangkyxe"])}),18e4);console.log(e)}},{key:"timeInit",value:function(){for(var t=[],e=0;e<23;)e<10?(t.push("0"+e+"g00"),t.push("0"+e+"g30")):(t.push(e+"g00"),t.push(e+"g30")),e++;return this.time=t}}]),t}()).\u0275fac=function(t){return new(t||R)(r.Sb(a.a),r.Sb(x),r.Sb(b),r.Sb(h.c),r.Sb(J.b),r.Sb(o.i),r.Sb(J.a))},R.\u0275cmp=r.Mb({type:R,selectors:[["app-order"]],decls:40,vars:8,consts:[[1,"container"],[1,"text-center","bg-warning","py-2","rounded"],["class","font-weight-bold",4,"ngIf"],["id","orderVehicle",3,"formGroup"],[1,"font-weight-bold"],["type","number","placeholder","S\u1ed1 ng\u01b0\u1eddi \u0111i","required","","formControlName","how",1,"form-control","mb-2"],["type","text","placeholder","N\u1ed9i dung c\xf4ng t\xe1c","required","","formControlName","todo",1,"form-control","mb-2"],[1,"row"],[1,"col-sm"],["type","text","list","time","placeholder","VD: 05g30","formControlName","timeGo",1,"form-control","mb-2"],["type","text","list","time","placeholder","VD: 16g30","formControlName","timeBack",1,"form-control","mb-2"],["type","date","placeholder","Ng\xe0y v\u1ec1","required","","formControlName","dayBack",1,"form-control","mb-2"],["type","text","placeholder","\u0110i\u1ec3m \u0111\u1ebfn","autocomplete","on","required","","formControlName","pointDes",1,"form-control","mb-2"],[4,"ngFor","ngForOf"],[1,"contact",3,"formGroup"],["type","text","list","users","placeholder","H\u1ecd v\xe0 t\xean + s\u1ed1 \u0111i\u1ec7n tho\u1ea1i, N\u01a1i \u0111\xf3n ...","required","","formControlName","pesonnel",1,"form-control","mb-2"],[1,"btn","btn-outline-info","my-1",3,"click"],["id","users"],["class","action my-2 text-center","style","font-size: 24px",4,"ngIf"],[1,"progress","my-2"],["role","progressbar","aria-valuenow","0","aria-valuemin","0","aria-valuemax","100",1,"progress-bar","progress-bar-animated","progress-bar-striped","bg-warning"],["id","time"],[3,"value",4,"ngFor","ngForOf"],[1,"fa","fa-trash","text-danger",3,"click"],[1,"action","my-2","text-center",2,"font-size","24px"],["type","button",1,"btn","btn-primary","mx-2","px-4",2,"font-size","24px",3,"disabled","click"],["aria-hidden","true",1,"fa","fa-floppy-o"],["type","button",1,"btn","btn-second","px-4",2,"font-size","24px",3,"click"],[1,"fa","fa-times","text-danger"],[3,"value"]],template:function(t,e){1&t&&(r.Yb(0,"div",0),r.Yb(1,"h4",1),r.Jc(2,"\u0110\u0102NG K\xdd XE C\xd4NG T\xc1C "),r.Xb(),r.Hc(3,P,2,2,"h4",2),r.Yb(4,"form",3),r.Yb(5,"label",4),r.Jc(6,"S\u1ed1 ng\u01b0\u1eddi \u0111i"),r.Xb(),r.Tb(7,"input",5),r.Yb(8,"label",4),r.Jc(9,"C\xf4ng t\xe1c"),r.Xb(),r.Tb(10,"input",6),r.Yb(11,"div",7),r.Yb(12,"div",8),r.Yb(13,"label",4),r.Jc(14,"Gi\u1edd \u0111i"),r.Xb(),r.Tb(15,"input",9),r.Xb(),r.Yb(16,"div",8),r.Yb(17,"label",4),r.Jc(18,"Gi\u1edd v\u1ec1"),r.Xb(),r.Tb(19,"input",10),r.Xb(),r.Yb(20,"div",8),r.Yb(21,"label",4),r.Jc(22,"Ng\xe0y v\u1ec1"),r.Xb(),r.Tb(23,"input",11),r.Xb(),r.Xb(),r.Yb(24,"label",4),r.Jc(25,"\u0110\u1ecba \u0111i\u1ec3m c\xf4ng t\xe1c"),r.Xb(),r.Tb(26,"input",12),r.Yb(27,"label",4),r.Jc(28,"Li\xean h\u1ec7"),r.Xb(),r.Hc(29,Z,4,2,"div",13),r.Xb(),r.Yb(30,"form",14),r.Tb(31,"input",15),r.Yb(32,"button",16),r.fc("click",(function(){return e.addContact()})),r.Jc(33,"Th\xeam li\xean h\u1ec7"),r.Xb(),r.Xb(),r.Tb(34,"datalist",17),r.Hc(35,E,5,1,"div",18),r.Yb(36,"div",19),r.Tb(37,"div",20),r.Xb(),r.Xb(),r.Yb(38,"datalist",21),r.Hc(39,W,1,1,"option",22),r.Xb()),2&t&&(r.Hb(3),r.pc("ngIf",e.vehicle),r.Hb(1),r.pc("formGroup",e.main),r.Hb(25),r.pc("ngForOf",e.contact),r.Hb(1),r.pc("formGroup",e.contactForm),r.Hb(5),r.pc("ngIf",e.waitId.length>0),r.Hb(2),r.Fc("width",e.remain+"%"),r.Hb(2),r.pc("ngForOf",e.time))},directives:[o.m,h.u,h.k,h.e,h.o,h.b,h.q,h.j,h.d,o.l,h.n,h.t],styles:[""]}),R);function tt(t,e){if(1&t){var i=r.Zb();r.Yb(0,"tr"),r.Yb(1,"td"),r.Jc(2),r.Xb(),r.Yb(3,"td",45),r.fc("click",(function(){r.zc(i);var t=e.$implicit;return r.jc(2).log(t)})),r.Jc(4),r.Xb(),r.Yb(5,"td"),r.Jc(6),r.kc(7,"date"),r.Xb(),r.Yb(8,"td"),r.Jc(9),r.kc(10,"date"),r.Xb(),r.Yb(11,"td"),r.Jc(12),r.kc(13,"number"),r.Xb(),r.Yb(14,"td"),r.Yb(15,"button",46),r.fc("click",(function(){r.zc(i);var t=e.$implicit;return r.jc(2).editItem(t)})),r.Tb(16,"i",47),r.Xb(),r.Yb(17,"button",48),r.fc("click",(function(){r.zc(i);var t=e.$implicit,n=e.index;return r.jc(2).delItem(t._id,n)})),r.Tb(18,"i",49),r.Xb(),r.Xb(),r.Xb()}if(2&t){var n=e.$implicit;r.Hb(2),r.Kc(n.vehicleId.label),r.Hb(2),r.Kc(n.regType),r.Hb(2),r.Kc(r.mc(7,5,n.fromDate,"dd/MM/yyyy")),r.Hb(3),r.Kc(r.mc(10,8,n.toDate,"dd/MM/yyyy")),r.Hb(3),r.Kc(r.lc(13,11,n.cost))}}function et(t,e){if(1&t&&(r.Yb(0,"tbody"),r.Hc(1,tt,19,13,"tr",44),r.Xb()),2&t){var i=r.jc();r.Hb(1),r.pc("ngForOf",i.DBlist)}}function it(t,e){1&t&&(r.Yb(0,"div",50),r.Tb(1,"i",51),r.Xb())}function nt(t,e){if(1&t&&(r.Yb(0,"span"),r.Jc(1),r.Xb()),2&t){var i=r.jc();r.Hb(1),r.Lc(" ",i.itemSelected.vehicleId.label,"")}}function ct(t,e){if(1&t){var i=r.Zb();r.Yb(0,"tr"),r.Yb(1,"td"),r.Jc(2),r.Xb(),r.Yb(3,"td"),r.Jc(4),r.Xb(),r.Yb(5,"td"),r.Jc(6),r.Xb(),r.Yb(7,"td"),r.Yb(8,"button",13),r.fc("click",(function(){r.zc(i);var t=e.$implicit;return r.jc(3).selectVehicle(t)})),r.Jc(9,"Ch\u1ecdn"),r.Xb(),r.Xb(),r.Xb()}if(2&t){var n=e.$implicit;r.Hb(2),r.Kc(n.label),r.Hb(2),r.Kc(n.type),r.Hb(2),r.Kc(n.brand)}}function ot(t,e){if(1&t&&(r.Yb(0,"table",4),r.Yb(1,"thead",5),r.Yb(2,"tr"),r.Yb(3,"th"),r.Jc(4,"Bi\u1ec3n s\u1ed1"),r.Xb(),r.Yb(5,"th"),r.Jc(6,"Lo\u1ea1i xe"),r.Xb(),r.Yb(7,"th"),r.Jc(8,"Hi\u1ec7u xe"),r.Xb(),r.Tb(9,"th"),r.Xb(),r.Xb(),r.Yb(10,"tbody"),r.Hc(11,ct,10,3,"tr",44),r.Xb(),r.Xb()),2&t){var i=r.jc(2);r.Hb(11),r.pc("ngForOf",i.vehicleList)}}var at=function(t){return{loading:t}};function rt(t,e){if(1&t){var i=r.Zb();r.Yb(0,"div",2),r.Yb(1,"input",52),r.fc("change",(function(){return r.zc(i),r.jc().getVehicles()})),r.Xb(),r.Hc(2,ot,12,1,"table",53),r.Xb()}if(2&t){var n=r.jc();r.pc("formGroup",n.searchVehicle),r.Hb(1),r.pc("ngClass",r.uc(3,at,n.loading)),r.Hb(1),r.pc("ngIf",n.vehicleList.length>0)}}function st(t,e){if(1&t&&(r.Yb(0,"div",27),r.Yb(1,"div",28),r.Yb(2,"h6"),r.Jc(3,"Xe:"),r.Xb(),r.Xb(),r.Yb(4,"div",29),r.Jc(5," \xa0"),r.Yb(6,"h6"),r.Jc(7),r.Xb(),r.Xb(),r.Xb()),2&t){var i=r.jc();r.Hb(7),r.Mc("",i.vehicleSelected.label," - ",i.vehicleSelected.brand,"")}}var lt,bt=((lt=function(){function t(e,i,n,c){_classCallCheck(this,t),this.plus=e,this.vehicleSV=i,this.fb=n,this.route=c,this.api="registry/",this.loading=!0,this.DBlist=[],this.vehicleList=[],this.vehicleSelected=null,this.today=this.plus.dateYMD((new Date).toISOString()),this.main=this.fb.group({_id:[,[]],vehicleId:[,[h.s.required]],regType:[,[h.s.required]],fromDate:[,[h.s.required]],toDate:[,[h.s.required]],cost:[,[]]}),this.search=this.fb.group({what:["",[h.s.minLength(4),h.s.maxLength(100)]]}),this.searchVehicle=this.fb.group({what:["",[h.s.minLength(4),h.s.maxLength(100)]]})}return _createClass(t,[{key:"ngOnInit",value:function(){this.getReg(),this.find(),this.getVehicles()}},{key:"getReg",value:function(){var t=this;this.plus.httpPost(this.api+"find",{page:1}).subscribe((function(e){t.plus.alertToasrt(e),t.DBlist=e,t.loading=!1}))}},{key:"find",value:function(){var t=this;this.search.valid&&this.search.valueChanges.pipe(Object(d.a)(1500)).subscribe((function(e){t.loading=!0,e.what=t.plus.removeAccents(e.what),t.plus.httpPost(t.api+"find",e).subscribe((function(e){t.loading=!1,e.length>0&&(t.DBlist=e)}))}))}},{key:"submit",value:function(){var t=this.plus.generateData(this.main.value);t._id?this.update(t):this.create(t),this.resetModal(),this.ngOnInit()}},{key:"create",value:function(t){var e=this;this.plus.httpPost(this.api,t).subscribe((function(i){e.plus.alertToasrt(i),i.msg&&(e.DBlist.push(t),e.plus.sortArr(e.DBlist,"dateModify"),e.resetModal()),e.getReg()}))}},{key:"update",value:function(t){var e=this;this.plus.httpPut(this.api,t).subscribe((function(t){e.plus.alertToasrt(t),t.msg&&e.resetModal()}))}},{key:"resetModal",value:function(){this.plus.clickBtn("closeModal"),this.main.reset(),this.itemSelected=null,this.vehicleList=[]}},{key:"loadMore",value:function(){var t=this,e=Math.ceil(this.DBlist.length/10)+1;this.plus.httpPost(this.api+"find",{page:e}).subscribe((function(e){e.length>0?e.forEach((function(e){t.DBlist.push(e)})):t.plus.alertToasrt({msg:"Kh\xf4ng\xa0c\xf2n\xa0k\u1ebft\xa0qu\u1ea3\xa0ph\xf9\xa0h\u1ee3p\xa0\n\xa0Nh\u1eadp\xa0n\u1ed9i\xa0dung\xa0c\u1ea7n\xa0t\xecm\xa0c\u1ee5\xa0th\u1ec3\xa0h\u01a1n"}),t.loading=!1}))}},{key:"addItem",value:function(){this.resetModal(),this.plus.clickBtn("openModal")}},{key:"editItem",value:function(t){var e=t;this.itemSelected=e,e.fromDate=this.plus.UTCtoYMD(e.fromDate),e.toDate=this.plus.UTCtoYMD(e.toDate),this.main.patchValue(t),this.plus.clickBtn("openModal"),console.log(e)}},{key:"delItem",value:function(t,e){var i=this;this.plus.httpDelete(this.api,t).subscribe((function(t){i.plus.alertToasrt(t),t.msg&&i.DBlist.splice(e,1)}))}},{key:"getVehicles",value:function(){var t=this;this.searchVehicle.valid&&this.searchVehicle.valueChanges.pipe(Object(d.a)(1500)).subscribe((function(e){t.loading=!0,e.what=t.plus.removeAccents(e.what),t.plus.httpPost("vehicle/find",e).subscribe((function(e){t.loading=!1,e.length>0?t.vehicleList=e:t.plus.alertToasrt({war:"Kh\xf4ng c\xf3 k\u1ebft qu\u1ea3 ph\xf9 h\u1ee3p"})}))}))}},{key:"selectVehicle",value:function(t){console.log(t),this.main.controls.vehicleId.setValue(t._id),this.vehicleSelected=t,this.vehicleList=[]}},{key:"log",value:function(t){console.log(t)}}]),t}()).\u0275fac=function(t){return new(t||lt)(r.Sb(a.a),r.Sb(b),r.Sb(h.c),r.Sb(J.a))},lt.\u0275cmp=r.Mb({type:lt,selectors:[["app-registry"]],decls:90,vars:11,consts:[[1,"container"],[1,"text-primary","text-center","bg-light","py-2","rounded"],[1,"form-group",3,"formGroup"],["list","students","type","text","formControlName","what","aria-describedby","helpId","placeholder","Nh\u1eadp th\xf4ng tin b\u1ea1n c\u1ea7n t\xecm","autocomplete","on",1,"form-control",3,"ngClass"],[1,"table","table-hover"],[1,"thead-default"],["type","button",1,"btn","btn-success","mx-1",3,"click"],[1,"fa","fa-plus"],["type","button",1,"btn","btn-primary","mx-1",3,"click"],["aria-hidden","true",1,"fa","fa-refresh"],[4,"ngIf"],["class","text-center text-primary",4,"ngIf"],[1,"loadMore","text-center","my-2"],["type","button",1,"btn","btn-outline-primary",3,"click"],["type","button","id","openModal","hidden","","data-toggle","modal","data-target","#modelId"],["id","modelId","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",1,"modal","fade"],["myModal",""],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header"],[1,"modal-title"],["type","button","data-dismiss","modal","aria-label","Close",1,"close"],["aria-hidden","true"],[1,"modal-body"],["class","form-group",3,"formGroup",4,"ngIf"],[3,"formGroup"],["class","row",4,"ngIf"],[1,"row"],[1,"col-sm-4"],[1,"col-sm-8"],[1,"form-group"],["formControlName","regType",1,"form-control"],["value","\u0110\u0103ng ki\u1ec3m"],["value","C\u01b0\u1edbc \u0111\u01b0\u1eddng b\u1ed9"],["value","B\u1ea3o hi\u1ec3m b\u1eaft bu\u1ed9c"],["value","B\u1ea3o hi\u1ec3m v\u1eadt ch\u1ea5t"],["value","Ph\xed VTEC"],[1,"row","form-group"],["type","date","formControlName","fromDate",1,"form-control"],["type","date","formControlName","toDate",1,"form-control"],["type","number","formControlName","cost",1,"form-control"],[1,"modal-footer"],["id","closeModal","type","button","data-dismiss","modal",1,"btn","btn-secondary"],["type","button","data-dismiss","modal",1,"btn","btn-primary",3,"disabled","click"],[4,"ngFor","ngForOf"],[3,"click"],["type","button",1,"btn","btn-outline-success","mx-1",3,"click"],[1,"fa","fa-pencil"],["type","button",1,"btn","btn-outline-danger","mx-1",3,"click"],[1,"fa","fa-trash"],[1,"text-center","text-primary"],[1,"fa","fa-spinner","fa-spin",2,"font-size","36px"],["type","text","required","","formControlName","what","placeholder","Nh\u1eadp th\xf4ng tin xe c\u1ea7n t\xecm v\xe0 ch\u1ecdn",1,"form-control",3,"ngClass","change"],["class","table table-hover",4,"ngIf"]],template:function(t,e){1&t&&(r.Yb(0,"div",0),r.Yb(1,"h4",1),r.Jc(2," H\u1ea0N D\xd9NG Y\xcaU C\u1ea6U "),r.Xb(),r.Yb(3,"div",2),r.Tb(4,"input",3),r.Xb(),r.Yb(5,"table",4),r.Yb(6,"thead",5),r.Yb(7,"tr"),r.Yb(8,"th"),r.Jc(9,"Xe"),r.Xb(),r.Yb(10,"th"),r.Jc(11,"Lo\u1ea1i h\u1ed3 s\u01a1"),r.Xb(),r.Yb(12,"th"),r.Jc(13,"Ng\xe0y s\u1eed d\u1ee5ng"),r.Xb(),r.Yb(14,"th"),r.Jc(15,"Ng\xe0y h\u1ebft h\u1ea1n"),r.Xb(),r.Yb(16,"th"),r.Jc(17,"S\u1ed1 ti\u1ec1n"),r.Xb(),r.Yb(18,"th"),r.Yb(19,"button",6),r.fc("click",(function(){return e.addItem()})),r.Tb(20,"i",7),r.Xb(),r.Yb(21,"button",8),r.fc("click",(function(){return e.ngOnInit()})),r.Tb(22,"i",9),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Hc(23,et,2,1,"tbody",10),r.Xb(),r.Hc(24,it,2,0,"div",11),r.Yb(25,"div",12),r.Yb(26,"button",13),r.fc("click",(function(){return e.loadMore()})),r.Jc(27,"Xem th\xeam"),r.Xb(),r.Xb(),r.Xb(),r.Yb(28,"button",14),r.Jc(29,"Modal"),r.Xb(),r.Yb(30,"div",15,16),r.Yb(32,"div",17),r.Yb(33,"div",18),r.Yb(34,"div",19),r.Yb(35,"h5",20),r.Jc(36,"Nh\u1eadp th\xf4ng tin xe "),r.Hc(37,nt,2,1,"span",10),r.Xb(),r.Yb(38,"button",21),r.Yb(39,"span",22),r.Jc(40,"\xd7"),r.Xb(),r.Xb(),r.Xb(),r.Yb(41,"div",23),r.Hc(42,rt,3,5,"div",24),r.Yb(43,"form",25),r.Hc(44,st,8,2,"div",26),r.Tb(45,"hr"),r.Yb(46,"div",27),r.Yb(47,"div",28),r.Yb(48,"h6"),r.Jc(49,"Lo\u1ea1i h\u1ed3 s\u01a1:"),r.Xb(),r.Xb(),r.Yb(50,"div",29),r.Yb(51,"div",30),r.Yb(52,"select",31),r.Yb(53,"option",32),r.Jc(54,"\u0110\u0103ng ki\u1ec3m"),r.Xb(),r.Yb(55,"option",33),r.Jc(56,"C\u01b0\u1edbc \u0111\u01b0\u1eddng b\u1ed9"),r.Xb(),r.Yb(57,"option",34),r.Jc(58,"B\u1ea3o hi\u1ec3m b\u1eaft bu\u1ed9c"),r.Xb(),r.Yb(59,"option",35),r.Jc(60,"B\u1ea3o hi\u1ec3m v\u1eadt ch\u1ea5t"),r.Xb(),r.Yb(61,"option",36),r.Jc(62,"Ph\xed VTEC"),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Tb(63,"hr"),r.Yb(64,"div",37),r.Yb(65,"div",28),r.Yb(66,"h6"),r.Jc(67,"Ng\xe0y s\u1eed d\u1ee5ng:"),r.Xb(),r.Xb(),r.Yb(68,"div",29),r.Tb(69,"input",38),r.Xb(),r.Xb(),r.Tb(70,"hr"),r.Yb(71,"div",37),r.Yb(72,"div",28),r.Yb(73,"h6"),r.Jc(74,"Ng\xe0y h\u1ebft h\u1ea1n:"),r.Xb(),r.Xb(),r.Yb(75,"div",29),r.Tb(76,"input",39),r.Xb(),r.Xb(),r.Tb(77,"hr"),r.Yb(78,"div",37),r.Yb(79,"div",28),r.Yb(80,"h6"),r.Jc(81,"S\u1ed1 ti\u1ec1n:"),r.Xb(),r.Xb(),r.Yb(82,"div",29),r.Tb(83,"input",40),r.Xb(),r.Xb(),r.Tb(84,"hr"),r.Xb(),r.Xb(),r.Yb(85,"div",41),r.Yb(86,"button",42),r.Jc(87,"H\u1ee7y"),r.Xb(),r.Yb(88,"button",43),r.fc("click",(function(){return e.submit()})),r.Jc(89,"L\u01b0u"),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb()),2&t&&(r.Hb(3),r.pc("formGroup",e.search),r.Hb(1),r.pc("ngClass",r.uc(9,at,e.loading)),r.Hb(19),r.pc("ngIf",e.DBlist.length>0),r.Hb(1),r.pc("ngIf",e.loading),r.Hb(13),r.pc("ngIf",e.itemSelected),r.Hb(5),r.pc("ngIf",!e.itemSelected),r.Hb(1),r.pc("formGroup",e.main),r.Hb(1),r.pc("ngIf",e.vehicleSelected),r.Hb(44),r.pc("disabled",!e.main.valid))},directives:[h.k,h.e,h.b,h.j,h.d,o.k,o.m,h.u,h.r,h.n,h.t,h.o,o.l,h.q],pipes:[o.d,o.e],styles:[""]}),lt),ht=i("mrSG");function dt(t,e){if(1&t){var i=r.Zb();r.Yb(0,"button",43),r.fc("click",(function(){r.zc(i);var t=r.jc(),e=t.$implicit,n=t.index;return r.jc(2).accept(e,n)})),r.Tb(1,"i",44),r.Xb()}}function ut(t,e){if(1&t){var i=r.Zb();r.Yb(0,"button",45),r.fc("click",(function(){r.zc(i);var t=r.jc().$implicit;return r.jc(2).editItem(t)})),r.Tb(1,"i",46),r.Xb()}}function pt(t,e){if(1&t){var i=r.Zb();r.Yb(0,"button",47),r.fc("click",(function(){r.zc(i);var t=r.jc().$implicit;return r.jc(2).changeStatus(t)})),r.Tb(1,"i",48),r.Xb()}}function ft(t,e){if(1&t){var i=r.Zb();r.Yb(0,"tr"),r.Yb(1,"td"),r.Jc(2),r.Xb(),r.Yb(3,"td"),r.Jc(4),r.Xb(),r.Yb(5,"td"),r.Jc(6),r.Xb(),r.Yb(7,"td"),r.Jc(8),r.kc(9,"date"),r.Xb(),r.Yb(10,"td"),r.Jc(11),r.Xb(),r.Yb(12,"td"),r.Hc(13,dt,2,0,"button",38),r.Hc(14,ut,2,0,"button",39),r.Yb(15,"button",40),r.fc("click",(function(){r.zc(i);var t=e.$implicit;return r.jc(2).download(t)})),r.Tb(16,"i",41),r.Xb(),r.Hc(17,pt,2,0,"button",42),r.Xb(),r.Xb()}if(2&t){var n=e.$implicit,c=r.jc(2);r.Hb(2),r.Kc(n.vehicleId.label),r.Hb(2),r.Kc(n.vehicleId.type),r.Hb(2),r.Kc(n.driverId.fullName||n.driverId.displayName),r.Hb(2),r.Kc(r.mc(9,8,n.dateGo,"dd/MM/yyyy")),r.Hb(3),r.Kc(n.todo),r.Hb(2),r.pc("ngIf",1!==n.orderStatus),r.Hb(1),r.pc("ngIf",1!==n.orderStatus),r.Hb(3),r.pc("ngIf",c.admin)}}function mt(t,e){if(1&t){var i=r.Zb();r.Yb(0,"table",33),r.Yb(1,"thead",34),r.Yb(2,"tr"),r.Yb(3,"th"),r.Jc(4,"Bi\u1ec3n s\u1ed1"),r.Xb(),r.Yb(5,"th"),r.Jc(6,"Lo\u1ea1i xe"),r.Xb(),r.Yb(7,"th"),r.Jc(8,"T\xe0i x\u1ebf"),r.Xb(),r.Yb(9,"th"),r.Jc(10,"Ng\xe0y \u0111i"),r.Xb(),r.Yb(11,"th"),r.Jc(12,"C\xf4ng t\xe1c"),r.Xb(),r.Yb(13,"th",35),r.Yb(14,"i",36),r.fc("click",(function(){return r.zc(i),r.jc().ngOnInit()})),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Yb(15,"tbody"),r.Hc(16,ft,18,11,"tr",37),r.Xb(),r.Xb()}if(2&t){var n=r.jc();r.Hb(16),r.pc("ngForOf",n.dbList)}}function vt(t,e){if(1&t&&(r.Yb(0,"span",49),r.Jc(1),r.Xb()),2&t){var i=r.jc();r.Hb(1),r.Kc(i.vehicleSelected.label)}}function gt(t,e){1&t&&r.Tb(0,"input",50)}function Yt(t,e){if(1&t){var i=r.Zb();r.Yb(0,"tr"),r.Yb(1,"td"),r.Jc(2),r.Xb(),r.Yb(3,"td"),r.Jc(4),r.Xb(),r.Yb(5,"td"),r.Yb(6,"button",31),r.fc("click",(function(){r.zc(i);var t=e.$implicit;return r.jc(2).selectVehicle(t)})),r.Jc(7,"Ch\u1ecdn"),r.Xb(),r.Xb(),r.Xb()}if(2&t){var n=e.$implicit;r.Hb(2),r.Kc(n.type),r.Hb(2),r.Kc(n.label)}}function Xt(t,e){if(1&t&&(r.Yb(0,"table",33),r.Yb(1,"thead",51),r.Yb(2,"tr"),r.Yb(3,"th"),r.Jc(4,"Lo\u1ea1i xe"),r.Xb(),r.Yb(5,"th"),r.Jc(6,"Bi\u1ec3n s\u1ed1"),r.Xb(),r.Tb(7,"th"),r.Xb(),r.Xb(),r.Yb(8,"tbody"),r.Hc(9,Yt,8,2,"tr",37),r.Xb(),r.Xb()),2&t){var i=r.jc();r.Hb(9),r.pc("ngForOf",i.vehicleList)}}function yt(t,e){if(1&t&&(r.Yb(0,"span",49),r.Jc(1),r.Xb()),2&t){var i=r.jc();r.Hb(1),r.Kc(i.userSelected.user_Id.fullName)}}function kt(t,e){1&t&&r.Tb(0,"input",52)}function Ht(t,e){if(1&t){var i=r.Zb();r.Yb(0,"tr"),r.Yb(1,"td"),r.Jc(2),r.Xb(),r.Yb(3,"td"),r.Jc(4),r.Xb(),r.Yb(5,"td"),r.Yb(6,"button",31),r.fc("click",(function(){r.zc(i);var t=e.$implicit;return r.jc(2).selectDriver(t)})),r.Jc(7,"Ch\u1ecdn"),r.Xb(),r.Xb(),r.Xb()}if(2&t){var n=e.$implicit;r.Hb(2),r.Kc(n.user_Id.fullName||"Ch\u01b0a khai b\xe1o"),r.Hb(2),r.Kc(n.level)}}function It(t,e){if(1&t&&(r.Yb(0,"table",33),r.Yb(1,"thead",51),r.Yb(2,"tr"),r.Yb(3,"th"),r.Jc(4,"H\u1ecd v\xe0 t\xean"),r.Xb(),r.Yb(5,"th"),r.Jc(6,"H\u1ea1ng b\u1eb1ng l\xe1i"),r.Xb(),r.Tb(7,"th"),r.Xb(),r.Xb(),r.Yb(8,"tbody"),r.Hc(9,Ht,8,2,"tr",37),r.Xb(),r.Xb()),2&t){var i=r.jc();r.Hb(9),r.pc("ngForOf",i.userList)}}var Jt,xt,Tt,St=function(t){return{loading:t}},Ct=[{path:"",component:A},{path:"quanlyxe",component:A},{path:"quanlydangkyxe",component:$},{path:"dangkyxe",component:L},{path:"dangkyxe/token/:token",component:Q},{path:"quyettoan",component:I},{path:"hansudung/:id",component:bt},{path:"hansudung",component:bt},{path:"duyetxe",component:(Jt=function(){function t(e,i){_classCallCheck(this,t),this.plus=e,this.fb=i,this.api="accept/",this.loading=!0,this.dbList=[],this.userList=[],this.vehicleList=[],this.userSelected=null,this.vehicleSelected=null,this.orderSelected=null,this.admin=this.plus.isAdmin(),this.from=localStorage.getItem("usrInfo"),this.main=this.fb.group({_id:[],vehicleId:[,[h.s.required]],driverId:[,[h.s.required]],how:[,[h.s.required]],todo:[,[h.s.required]],timeGo:[,[]],dateGo:[,[h.s.required]],timeBack:[,[]],dayBack:[,[h.s.required]],pointGo:[,[h.s.required]],pointDes:[,[h.s.required]],contact:[,[]],note:["",h.s.maxLength(100)]}),this.searchForm=this.fb.group({what:["",[h.s.minLength(4),h.s.maxLength(100)]]}),this.searchUser=this.fb.group({what:["",[h.s.minLength(4),h.s.maxLength(100)]]}),this.searchVehicle=this.fb.group({what:["",[h.s.minLength(4),h.s.maxLength(100)]]})}return _createClass(t,[{key:"ngOnInit",value:function(){this.get(),this.findUser(),this.findVehicle(),this.findOrder()}},{key:"get",value:function(){var t=this;this.plus.httpGet(this.api+"1").subscribe((function(e){t.dbList=e,t.plus.alertToasrt(e),t.loading=!1}))}},{key:"findOrder",value:function(){var t=this;this.searchForm.valid&&this.searchForm.valueChanges.pipe(Object(d.a)(1500)).subscribe((function(e){console.log(e),e.what&&e.what.length>3&&(t.loading=!0,e.what=t.plus.removeAccents(e.what),t.plus.httpPost("accept/find",e).subscribe((function(e){t.loading=!1,t.plus.alertToasrt(e),e.length>0&&(t.dbList=e)})))}))}},{key:"findVehicle",value:function(){var t=this;this.searchVehicle.valid&&this.searchVehicle.valueChanges.pipe(Object(d.a)(1500)).subscribe((function(e){console.log(e),e.what&&e.what.length>3&&(t.loading=!0,e.what=t.plus.removeAccents(e.what),t.plus.httpPost("vehicle/find",e).subscribe((function(e){t.loading=!1,t.plus.alertToasrt(e),e.length>0&&(t.vehicleList=e)})))}))}},{key:"findUser",value:function(){var t=this;this.searchUser.valid&&this.searchUser.valueChanges.pipe(Object(d.a)(1500)).subscribe((function(e){console.log(e),e.what&&e.what.length>3&&(e.what=t.plus.removeAccents(e.what),t.loading=!0,t.plus.httpPost("driver/find",e).subscribe((function(e){t.loading=!1,t.plus.alertToasrt(e),t.userList=e})))}))}},{key:"selectDriver",value:function(t){this.userSelected=t,this.userList=[],console.log(t),this.main.controls.driverId.setValue(t.user_Id._id)}},{key:"selectVehicle",value:function(t){this.vehicleSelected=t,this.vehicleList=[],console.log(t),this.main.controls.vehicleId.setValue(t._id)}},{key:"changeStatus",value:function(t){var e=this;this.plus.httpPut("order",{_id:t._id,orderStatus:0}).subscribe((function(t){e.plus.alertToasrt(t)}))}},{key:"editItem",value:function(t){console.log(t),this.orderSelected=t,this.main.patchValue(t),this.main.controls.vehicleId.setValue(t.vehicleId._id),this.main.controls.driverId.setValue(t.driverId._id),this.plus.clickBtn("openModal")}},{key:"reset",value:function(){this.plus.clickBtn("closeModal"),this.main.reset(),this.searchForm.reset(),this.searchUser.reset(),this.searchVehicle.reset(),this.orderSelected=null,this.userSelected=null,this.vehicleSelected=null}},{key:"submit",value:function(){var t=this,e=this.plus.addKeyWord(this.main.value);console.log(e),this.plus.httpPut("order",e).subscribe((function(e){t.plus.alertToasrt(e),t.plus.clickBtn("closeModal")}))}},{key:"accept",value:function(t,e){var i=this;console.log(t);var n={title:"Th\xf4ng b\xe1o c\xf4ng t\xe1c ng\xe0y ".concat(this.plus.dateToDMY(t.dateGo),"."),email:t.driverId.email,message:"<h4>Th\xf4ng b\xe1o c\xf4ng t\xe1c ng\xe0y ".concat(this.plus.dateToDMY(t.dateGo),":</h4>\n      <h4>Lo\u1ea1i xe: ").concat(t.vehicleId.type," - ").concat(t.vehicleId.label,".</h4>\n      <h4>Gi\u1edd \u0111i: ").concat(t.timeGo,".</h4>\n      <h4>C\xf4ng t\xe1c: ").concat(t.todo,".</h4>\n      <h4>\u0110\u1ecba \u0111i\u1ec3m: ").concat(t.pointDes,".</h4>\n      <h4>Li\xean h\u1ec7: ").concat(t.contact.join(", "),".</h4>\n      "),t0k3n:{user:"tckt.dlxl@gmail.com",pass:"pdhorsgfplhxhecj"}};1===t.orderStatus?(this.plus.alertToasrt({war:"B\u1ea1n \u0111\xe3 duy\u1ec7t xe n\xe0y!"}),this.get()):(this.plus.httpPost(this.api,{id:t._id,orderStatus:1}).subscribe((function(t){i.dbList[e].orderStatus=1,i.plus.alertToasrt(t)})),console.log(n),this.plus.sendMail(n).subscribe((function(e){return Object(ht.__awaiter)(i,void 0,void 0,regeneratorRuntime.mark((function i(){var c=this;return regeneratorRuntime.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:if(i.t0=e.email,!i.t0){i.next=7;break}return this.plus.alertToasrt({msg:"\u0110\xe3 g\u1eedi mail cho l\xe1i xe"}),i.next=5,this.plus.sleep(5e3);case 5:n.email=t.userId.email,this.plus.sendMail(n).subscribe((function(t){c.plus.alertToasrt({msg:"\u0110\xe3 g\u1eedi mail cho ng\u01b0\u1eddi \u0111\u0103ng k\xfd xe"})}));case 7:case"end":return i.stop()}}),i,this)})))})))}},{key:"download",value:function(t){JSON.parse(localStorage.getItem("usrInfo")).unit||this.plus.alertToasrt({err:"B\u1ea1n c\u1ea7n khai b\xe1o th\xeam th\xf4ng tin t\xe0i kho\u1ea3n c\u1ee7a b\u1ea1n"}),console.log(t);var e=Object.assign({},t);e.dateGo=this.plus.dateToDMY(e.dateGo),e.dayBack=this.plus.dateToDMY(e.dayBack)}}]),t}(),Jt.\u0275fac=function(t){return new(t||Jt)(r.Sb(a.a),r.Sb(h.c))},Jt.\u0275cmp=r.Mb({type:Jt,selectors:[["app-acception"]],decls:66,vars:14,consts:[[1,"form-group",3,"formGroup"],["type","text","placeholder","Nh\u1eadp th\xf4ng tin b\u1ea1n c\u1ea7n t\xecm","formControlName","what",1,"form-control",3,"ngClass","change"],["class","table table-hover",4,"ngIf"],["type","button","id","openModal","hidden","","data-toggle","modal","data-target","#regModal",1,"btn","btn-primary","btn-lg"],["id","regModal","tabindex","-1","role","dialog","aria-labelledby","modelTitleId","aria-hidden","true",1,"modal","fade"],["role","document",1,"modal-dialog"],[1,"modal-content"],[1,"modal-header","bg-primary"],[1,"modal-title","text-center","text-white"],["type","button","data-dismiss","modal","aria-label","Close",1,"close",3,"click"],["aria-hidden","true"],[1,"modal-body"],[1,"container"],[3,"formGroup"],[1,"form-group"],["class","text-danger",4,"ngIf"],["type","text","class","form-control","placeholder","Nh\u1eadp th\xf4ng tin xe c\u1ea7n \u0111\u1ed5i","formControlName","what",4,"ngIf"],[1,"vehicleList"],["type","text","class","form-control","placeholder","Nh\u1eadp th\xf4ng tin t\xe0i x\u1ebf c\u1ea7n \u0111\u1ed5i","formControlName","what",4,"ngIf"],[1,"userList"],["type","text","hidden","","formControlName","_id",1,"form-control"],[1,"row","form-group"],[1,"col-sm-4"],[1,"col-sm-8"],["type","number","formControlName","how",1,"form-control"],["rows","2","formControlName","todo",1,"form-control"],["type","text","formControlName","timeGo",1,"form-control"],["rows","3","formControlName","note",1,"form-control"],[1,"modal-footer"],["type","button","id","closeModal","data-dismiss","modal",1,"btn","btn-outline-danger",3,"click"],[1,"fa","fa-times"],["type","button",1,"btn","btn-outline-primary",3,"click"],[1,"fa","fa-floppy-o"],[1,"table","table-hover"],[1,"thead-default"],[1,"text-center","text-primary"],[1,"fa","fa-refresh",3,"click"],[4,"ngFor","ngForOf"],["type","button","class","btn btn-outline-warning mx-1","title","Duy\u1ec7t",3,"click",4,"ngIf"],["type","button","class","btn btn-outline-success mx-1",3,"click",4,"ngIf"],["type","button","data-toggle","modal","data-target","#modelId",1,"btn","btn-outline-primary","mx-1",3,"click"],["aria-hidden","true",1,"fa","fa-print","text-info"],["type","button","class","btn btn-outline-danger mx-1",3,"click",4,"ngIf"],["type","button","title","Duy\u1ec7t",1,"btn","btn-outline-warning","mx-1",3,"click"],["aria-hidden","true",1,"fa","fa-check"],["type","button",1,"btn","btn-outline-success","mx-1",3,"click"],["aria-hidden","true",1,"fa","fa-pencil"],["type","button",1,"btn","btn-outline-danger","mx-1",3,"click"],[1,"fa","fa-trash","text-danger"],[1,"text-danger"],["type","text","placeholder","Nh\u1eadp th\xf4ng tin xe c\u1ea7n \u0111\u1ed5i","formControlName","what",1,"form-control"],[1,"thead-inverse"],["type","text","placeholder","Nh\u1eadp th\xf4ng tin t\xe0i x\u1ebf c\u1ea7n \u0111\u1ed5i","formControlName","what",1,"form-control"]],template:function(t,e){1&t&&(r.Yb(0,"form",0),r.Yb(1,"input",1),r.fc("change",(function(){return e.findOrder()})),r.Xb(),r.Xb(),r.Hc(2,mt,17,1,"table",2),r.Tb(3,"button",3),r.Yb(4,"div",4),r.Yb(5,"div",5),r.Yb(6,"div",6),r.Yb(7,"div",7),r.Yb(8,"h5",8),r.Jc(9,"Hi\u1ec7u ch\u1ec9nh xe \u0111\u0103ng k\xfd"),r.Xb(),r.Yb(10,"button",9),r.fc("click",(function(){return e.reset()})),r.Yb(11,"span",10),r.Jc(12,"\xd7"),r.Xb(),r.Xb(),r.Xb(),r.Yb(13,"div",11),r.Yb(14,"div",12),r.Yb(15,"form",13),r.Yb(16,"div",14),r.Yb(17,"h6"),r.Jc(18,"\u0110\u1ed5i xe: "),r.Hc(19,vt,2,1,"span",15),r.Xb(),r.Hc(20,gt,1,0,"input",16),r.Xb(),r.Yb(21,"div",17),r.Hc(22,Xt,10,1,"table",2),r.Xb(),r.Xb(),r.Yb(23,"form",13),r.Yb(24,"div",14),r.Yb(25,"h6"),r.Jc(26,"\u0110\u1ed5i t\xe0i x\u1ebf: "),r.Hc(27,yt,2,1,"span",15),r.Xb(),r.Hc(28,kt,1,0,"input",18),r.Xb(),r.Yb(29,"div",19),r.Hc(30,It,10,1,"table",2),r.Xb(),r.Xb(),r.Yb(31,"form",13),r.Tb(32,"input",20),r.Yb(33,"div",21),r.Yb(34,"div",22),r.Yb(35,"h6"),r.Jc(36,"S\u1ed1 ng\u01b0\u1eddi \u0111i:"),r.Xb(),r.Xb(),r.Yb(37,"div",23),r.Tb(38,"input",24),r.Xb(),r.Xb(),r.Tb(39,"hr"),r.Yb(40,"div",21),r.Yb(41,"div",22),r.Yb(42,"h6"),r.Jc(43,"C\xf4ng t\xe1c:"),r.Xb(),r.Xb(),r.Yb(44,"div",23),r.Tb(45,"textarea",25),r.Xb(),r.Xb(),r.Tb(46,"hr"),r.Yb(47,"div",21),r.Yb(48,"div",22),r.Yb(49,"h6"),r.Jc(50,"Gi\u1edd \u0111i:"),r.Xb(),r.Xb(),r.Yb(51,"div",23),r.Tb(52,"input",26),r.Xb(),r.Xb(),r.Tb(53,"hr"),r.Yb(54,"div",21),r.Yb(55,"div",22),r.Yb(56,"h6"),r.Jc(57,"L\u1eddi nh\u1eafn cho l\xe1i xe"),r.Xb(),r.Xb(),r.Yb(58,"div",23),r.Tb(59,"textarea",27),r.Xb(),r.Xb(),r.Tb(60,"hr"),r.Xb(),r.Xb(),r.Xb(),r.Yb(61,"div",28),r.Yb(62,"button",29),r.fc("click",(function(){return e.reset()})),r.Tb(63,"i",30),r.Xb(),r.Yb(64,"button",31),r.fc("click",(function(){return e.submit()})),r.Tb(65,"i",32),r.Xb(),r.Xb(),r.Xb(),r.Xb(),r.Xb()),2&t&&(r.pc("formGroup",e.searchForm),r.Hb(1),r.pc("ngClass",r.uc(12,St,e.loading)),r.Hb(1),r.pc("ngIf",e.dbList.length>0),r.Hb(13),r.pc("formGroup",e.searchVehicle),r.Hb(4),r.pc("ngIf",e.vehicleSelected),r.Hb(1),r.pc("ngIf",!e.vehicleSelected),r.Hb(2),r.pc("ngIf",e.vehicleList.length>0),r.Hb(1),r.pc("formGroup",e.searchUser),r.Hb(4),r.pc("ngIf",e.userSelected),r.Hb(1),r.pc("ngIf",!e.userSelected),r.Hb(2),r.pc("ngIf",e.userList.length>0),r.Hb(1),r.pc("formGroup",e.main))},directives:[h.u,h.k,h.e,h.b,h.j,h.d,o.k,o.m,h.o,o.l],pipes:[o.d],styles:[""]}),Jt)},{path:"taixe",component:$}],wt=((Tt=function t(){_classCallCheck(this,t)}).\u0275mod=r.Qb({type:Tt}),Tt.\u0275inj=r.Pb({factory:function(t){return new(t||Tt)},imports:[[J.e.forChild(Ct)],J.e]}),Tt),Ot=((xt=function t(){_classCallCheck(this,t)}).\u0275mod=r.Qb({type:xt}),xt.\u0275inj=r.Pb({factory:function(t){return new(t||xt)},imports:[[o.b,wt,h.p,h.f]]}),xt)}}]);